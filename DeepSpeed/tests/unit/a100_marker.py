# Copyright (c) 2023 Habana Labs, Ltd. an Intel Company
# Copyright (c) Microsoft Corporation.
# SPDX-License-Identifier: Apache-2.0

# DeepSpeed Team

a100_tests = [
    "unit/runtime/half_precision/test_bf16.py::TestZero2ReduceScatterOff::test",
    "unit/runtime/half_precision/test_bf16.py::TestZeroSupportedClientOptimizer::test[FusedAdam]",
    "unit/runtime/half_precision/test_bf16.py::TestZeroSupportedClientOptimizer::test[Adam]",
    "unit/runtime/half_precision/test_bf16.py::TestZeroAllowUntestedOptimizer::test",
    "unit/runtime/half_precision/test_bf16.py::TestZeroEmptyPartition::test",
    "unit/runtime/half_precision/test_bf16.py::TestZeroDtypeCocktail::test[bfp16-bfp16]",
    "unit/runtime/half_precision/test_bf16.py::TestZeroDtypeCocktail::test[bfp16-fp32]",
    "unit/runtime/half_precision/test_bf16.py::TestZeroDtypeCocktail::test[fp16-bfp16]",
    "unit/runtime/half_precision/test_bf16.py::TestZeroDtypeCocktail::test[bfp16-fp16]",
    "unit/runtime/half_precision/test_bf16.py::TestZeroDtypeCocktail::test[default-bfp16]",
    "unit/runtime/half_precision/test_bf16.py::TestZeroEmptyGrad::test",
    "unit/runtime/half_precision/test_bf16.py::TestAdamBF16ZeroOneCycleCompatibility::test",
    "unit/runtime/compile/test_compile_zero.py::TestZeRO::test_compile_zero[nvme-3-dtype0]",
    "unit/runtime/compile/test_compile_zero.py::TestZeRO::test_compile_zero[cpu-2-dtype0]",
    "unit/runtime/compile/test_compile_zero.py::TestZeRO::test_compile_zero[none-2-dtype0]",
    "unit/runtime/compile/test_compile_zero.py::TestZeRO::test_compile_zero[nvme-2-dtype0]",
    "unit/runtime/compile/test_compile_zero.py::TestZeRO::test_compile_zero[cpu-3-dtype0]",
    "unit/runtime/compile/test_compile_zero.py::TestZeRO::test_compile_zero[none-1-dtype0]",
    "unit/runtime/compile/test_compile_zero.py::TestZeRO::test_compile_zero[nvme-1-dtype0]",
    "unit/runtime/compile/test_compile_zero.py::TestZeRO::test_compile_zero[none-3-dtype0]",
    "unit/runtime/compile/test_compile_zero.py::TestZeRO::test_compile_zero[cpu-1-dtype0]",
    "unit/runtime/test_ds_initialize.py::TestOptimizerImplementation::test[bf16-bf16-amp]",
    "unit/runtime/test_ds_initialize.py::TestOptimizerImplementation::test[fp16-bf16-amp]",
    "unit/runtime/test_ds_initialize.py::TestOptimizerImplementation::test[None-bf16-zero1]",
    "unit/runtime/test_ds_initialize.py::TestOptimizerImplementation::test[fp16-bf16-zero2]",
    "unit/runtime/test_ds_initialize.py::TestOptimizerImplementation::test[None-bf16-None]",
    "unit/runtime/test_ds_initialize.py::TestOptimizerImplementation::test[bf16-bf16-None]",
    "unit/runtime/test_ds_initialize.py::TestOptimizerImplementation::test[bf16-bf16-zero2]",
    "unit/runtime/test_ds_initialize.py::TestOptimizerImplementation::test[fp32-bf16-zero1]",
    "unit/runtime/test_ds_initialize.py::TestOptimizerImplementation::test[None-bf16-zero2]",
    "unit/runtime/test_ds_initialize.py::TestOptimizerImplementation::test[fp32-bf16-zero3]",
    "unit/runtime/test_ds_initialize.py::TestOptimizerImplementation::test[None-bf16-amp]",
    "unit/runtime/test_ds_initialize.py::TestOptimizerImplementation::test[fp32-bf16-None]",
    "unit/runtime/test_ds_initialize.py::TestOptimizerImplementation::test[fp32-bf16-amp]",
    "unit/runtime/test_ds_initialize.py::TestOptimizerImplementation::test[fp16-bf16-zero1]",
    "unit/runtime/test_ds_initialize.py::TestOptimizerImplementation::test[fp16-bf16-None]",
    "unit/runtime/test_ds_initialize.py::TestOptimizerImplementation::test[None-bf16-zero3]",
    "unit/runtime/test_ds_initialize.py::TestOptimizerImplementation::test[bf16-bf16-zero3]",
    "unit/runtime/test_ds_initialize.py::TestOptimizerImplementation::test[fp16-bf16-zero3]",
    "unit/runtime/test_ds_initialize.py::TestOptimizerImplementation::test[bf16-bf16-zero1]",
    "unit/runtime/test_ds_initialize.py::TestOptimizerImplementation::test[fp32-bf16-zero2]",
    "unit/checkpoint/test_universal_checkpoint.py::TestZeROUniversalCheckpointDP::test_dp_world_size_2to2[False-False-1-dtype0]",
    "unit/checkpoint/test_universal_checkpoint.py::TestZeROUniversalCheckpointDP::test_dp_world_size_4to2[False-False-1-dtype0]",
    "unit/checkpoint/test_universal_checkpoint.py::TestZeROUniversalCheckpointDP::test_dp_world_size_2to4[True-False-1-dtype0]",
    "unit/checkpoint/test_universal_checkpoint.py::TestZeROUniversalCheckpointDP::test_dp_world_size_2to4[True-True-1-dtype0]",
    "unit/checkpoint/test_universal_checkpoint.py::TestZeROUniversalCheckpointDP::test_dp_world_size_2to4[False-True-1-dtype0]",
    "unit/checkpoint/test_universal_checkpoint.py::TestZeROUniversalCheckpointDP::test_dp_world_size_4to2[False-True-1-dtype0]",
    "unit/checkpoint/test_universal_checkpoint.py::TestZeROUniversalCheckpointDP::test_dp_world_size_2to2[True-True-1-dtype0]",
    "unit/checkpoint/test_universal_checkpoint.py::TestZeROUniversalCheckpointDP::test_dp_world_size_2to2[False-True-1-dtype0]",
    "unit/checkpoint/test_universal_checkpoint.py::TestZeROUniversalCheckpointDP::test_dp_world_size_4to2[True-True-1-dtype0]",
    "unit/checkpoint/test_universal_checkpoint.py::TestZeROUniversalCheckpointDP::test_dp_world_size_4to2[True-False-1-dtype0]",
    "unit/checkpoint/test_universal_checkpoint.py::TestZeROUniversalCheckpointDP::test_dp_world_size_2to2[True-False-1-dtype0]",
    "unit/checkpoint/test_universal_checkpoint.py::TestZeROUniversalCheckpointDP::test_dp_world_size_2to4[False-False-1-dtype0]",
    "unit/runtime/zero/test_zero_tensor_fragment.py::TestTensorFragmentGet::test_bf16_fragments[False]",
    "unit/runtime/sparse_tensor/test_averaging_sparse_gradients.py::TestSparseAdam::test",
    "unit/runtime/pipe/test_pipe.py::TestPipeCifar10::test_pipe_base[topo_config0]",
    "unit/runtime/pipe/test_pipe.py::TestPipeCifar10::test_pipe_use_reentrant[topo_config2]",
    "unit/runtime/pipe/test_pipe.py::TestPipeCifar10::test_pipe_base[topo_config2]",
    "unit/runtime/pipe/test_pipe.py::TestPipeCifar10::test_pipe_use_reentrant[topo_config1]",
    "unit/runtime/pipe/test_pipe.py::TestPipeCifar10::test_pipe_use_reentrant[topo_config0]",
    "unit/runtime/pipe/test_pipe.py::TestPipeCifar10::test_pipe_base[topo_config1]",
    "unit/checkpoint/test_pipeline.py::TestPipelineCheckpoint::test_checkpoint_pipe_engine[1-False]",
    "unit/checkpoint/test_pipeline.py::TestPipelineCheckpoint::test_checkpoint_pipe_engine[0-False]",
    "unit/runtime/zero/test_nvme_checkpointing.py::TestNVMeCheckpointing::test_nvme_checkpointing[nvme-nvme]",
    "unit/runtime/zero/test_nvme_checkpointing.py::TestNVMeCheckpointing::test_nvme_checkpointing[cpu-nvme]",
    "unit/runtime/zero/test_nvme_checkpointing.py::TestNVMeCheckpointing::test_nvme_checkpointing[cpu-cpu]",
    "unit/runtime/zero/test_zero_tensor_fragment.py::TestTensorFragmentUpdate::test_zero_fragments[nvme-3-full-dtype0]",
    "unit/runtime/zero/test_zero_tensor_fragment.py::TestTensorFragmentUpdate::test_zero_fragments[nvme-3-local-dtype1]",
    "unit/runtime/zero/test_zero_tensor_fragment.py::TestTensorFragmentUpdate::test_zero_fragments[nvme-3-local-dtype2]",
    "unit/runtime/zero/test_zero_tensor_fragment.py::TestTensorFragmentUpdate::test_zero_fragments[nvme-3-full-dtype2]",
    "unit/runtime/zero/test_zero_tensor_fragment.py::TestTensorFragmentUpdate::test_zero_fragments[nvme-3-full-dtype1]",
    "unit/runtime/zero/test_zero_tensor_fragment.py::TestTensorFragmentUpdate::test_zero_fragments[nvme-3-local-dtype0]",
    "unit/runtime/zero/test_zero_tensor_fragment.py::TestTensorFragmentGet::test_zero_fragments[nvme-3-local-False]",
    "unit/runtime/zero/test_zero_tensor_fragment.py::TestTensorFragmentGet::test_zero_fragments[nvme-3-local-True]",
    "unit/runtime/zero/test_zero_tensor_fragment.py::TestTensorFragmentGet::test_zero_fragments[nvme-3-full-False]",
    "unit/runtime/zero/test_zero_tensor_fragment.py::TestTensorFragmentGet::test_zero_fragments[nvme-3-full-True]",
    "unit/linear/test_ctx.py::TestEngine::test_model",
    "unit/runtime/test_no_sync_ctxt.py::TestNoSyncCtxt::test_engine_step[0-dtype1]",
    "unit/runtime/test_no_sync_ctxt.py::TestNoSyncCtxt::test_multiple_ctxts[0-dtype1]",
    "unit/runtime/test_no_sync_ctxt.py::TestNoSyncCtxt::test_zero_stage[3-dtype1]",
    "unit/runtime/test_no_sync_ctxt.py::TestNoSyncCtxt::test_zero_stage[0-dtype1]",
    "unit/runtime/test_no_sync_ctxt.py::TestNoSyncCtxt::test_engine_step[1-dtype1]",
    "unit/runtime/test_no_sync_ctxt.py::TestNoSyncCtxt::test_zero_stage[2-dtype1]",
    "unit/runtime/test_no_sync_ctxt.py::TestNoSyncCtxt::test_multiple_ctxts[1-dtype1]",
    "unit/runtime/test_no_sync_ctxt.py::TestNoSyncCtxt::test_zero_stage[1-dtype1]",
    "unit/runtime/zero/test_offload_states.py::TestOffloadStates::test_offload_states[True-False-contiguous_grad_buffer]",
    "unit/runtime/zero/test_offload_states.py::TestOffloadStates::test_offload_states[False-False-optim_states]",
    "unit/runtime/zero/test_offload_states.py::TestOffloadStates::test_offload_states[True-False-None]",
    "unit/runtime/zero/test_offload_states.py::TestOffloadStates::test_offload_states[False-False-hp_params]",
    "unit/runtime/zero/test_offload_states.py::TestOffloadStates::test_offload_states[True-True-contiguous_grad_buffer]",
    "unit/runtime/zero/test_offload_states.py::TestOffloadStates::test_offload_states[True-False-optim_states]",
    "unit/runtime/zero/test_offload_states.py::TestOffloadStates::test_offload_states[True-True-hp_params]",
    "unit/runtime/zero/test_offload_states.py::TestOffloadStates::test_offload_states[False-False-lp_grads]",
    "unit/runtime/zero/test_offload_states.py::TestOffloadStates::test_offload_states[False-True-hp_params]",
    "unit/runtime/zero/test_offload_states.py::TestOffloadStates::test_offload_states[True-False-lp_params]",
    "unit/runtime/zero/test_offload_states.py::TestOffloadStates::test_offload_states[False-True-None]",
    "unit/runtime/zero/test_offload_states.py::TestOffloadStates::test_offload_states[True-False-lp_grads]",
    "unit/runtime/zero/test_offload_states.py::TestOffloadStates::test_offload_states[True-True-lp_grads]",
    "unit/runtime/zero/test_offload_states.py::TestOffloadStates::test_offload_states[False-True-contiguous_grad_buffer]",
    "unit/runtime/zero/test_offload_states.py::TestOffloadStates::test_offload_states[False-True-lp_params]",
    "unit/runtime/zero/test_offload_states.py::TestOffloadStates::test_offload_states[True-True-None]",
    "unit/runtime/zero/test_offload_states.py::TestOffloadStates::test_offload_states[True-True-optim_states]",
    "unit/runtime/zero/test_offload_states.py::TestOffloadStates::test_offload_states[True-True-lp_params]",
    "unit/runtime/zero/test_offload_states.py::TestOffloadStates::test_offload_states[False-True-lp_grads]",
    "unit/runtime/zero/test_offload_states.py::TestOffloadStates::test_offload_states[False-False-None]",
    "unit/runtime/zero/test_offload_states.py::TestOffloadStates::test_offload_states[True-False-hp_params]",
    "unit/runtime/zero/test_offload_states.py::TestOffloadStates::test_offload_states[False-False-lp_params]",
    "unit/runtime/zero/test_offload_states.py::TestOffloadStates::test_offload_states[False-True-optim_states]",
    "unit/runtime/zero/test_offload_states.py::TestOffloadStates::test_offload_states[False-False-contiguous_grad_buffer]",
    "unit/runtime/zero/test_zero.py::TestEmptyParameterGroup::test_empty_param_groups[dtype0-True-True]",
    "unit/runtime/zero/test_zero.py::TestEmptyParameterGroup::test_empty_param_groups[dtype0-False-True]",
    "unit/runtime/zero/test_zero.py::TestEmptyParameterGroup::test_empty_param_groups[dtype0-False-False]",
    "unit/runtime/zero/test_zero.py::TestEmptyParameterGroup::test_empty_param_groups[dtype0-True-False]",
    "unit/inference/test_inference.py::TestAutoTensorParallelism::test_odd_world_size[bf16-marian-False-False]",
    "unit/runtime/zero/test_zero_tensor_fragment.py::TestTensorFragmentUpdate::test_zero_fragments[cpu-2-full-dtype0] ",
    "unit/runtime/zero/test_zero_tensor_fragment.py::TestTensorFragmentUpdate::test_zero_fragments[none-3-full-dtype0]",
]
